"use strict";var JFAudioPlayer=function(){var b,c,d,e,f,g,a=this;this.input=arguments[0],this.Container=null,this.playContainer=null,this.audioSource=null,this.currentPlayList=[],this.isRowPlay=!1,this.audioStatus={canplay:null,canplaythrough:null,ended:null,loadeddata:null,loadedmetadata:null,pause:null,play:null,playing:null,progress:null},this._safariHack=function(){var c=this,d=a.input["autoplay"];if("undefined"!=typeof d&&0==d);else{if(!c.audioStatus.playing)try{c.audioSource.getAttribute("src")?c.audioSource.play():console.warn("audioSource的资源路径不合法！")}catch(e){console.log(e)}setTimeout(function(){c.audioStatus.playing||JFUtil.addHandler(document,"touchstart",b)},500)}},b=function(){a.start(),JFUtil.removeHandler(document,"touchstart")},this._playStatusHelper=function(a){var b=this,c=function(a){var c=a.type;b.audioStatus[c]=!0,"ended"==c&&(b.audioStatus.pause=!0,b.audioStatus.playing=!1,b.audioStatus.progress=!1),"palying"==c&&(b.audioStatus.ended=!1,b.audioStatus.pause=!1)},d=function(a){c(a)};"undefined"!=typeof a&&(a.addEventListener("canplay",d,!1),a.addEventListener("canplaythrough",d,!1),a.addEventListener("ended",d,!1),a.addEventListener("loadeddata",d,!1),a.addEventListener("loadedmetadata",d,!1),a.addEventListener("pause",d,!1),a.addEventListener("playing",d,!1),a.addEventListener("progress",d,!1))},this._init=function(){var b=this,f=b.input;c(),f["srcList"]||f["sourceList"]?(a.isRowPlay=!0,e(f)):(a.isRowPlay=!1,d(f))},c=function(){var c,b=document.querySelector("#JFAudioPlayerContainer");return b?(c=b.querySelector("#JFAudioList"),c||(b.innerHTML='<div id="JFAudioList" class="JFAudioList"></div>')):(b=document.createElement("div"),b.id="JFAudioPlayerContainer",b.innerHTML='<div id="JFAudioList" class="JFAudioList"></div><button data-JFcontrol="stop" name="JFcontrol">stop</button> <button data-JFcontrol="pause" name="JFcontrol">pause</button> <button data-JFcontrol="restart" name="JFcontrol">restart</button> <button data-JFcontrol="start" name="JFcontrol">start</button> ',document.body.appendChild(b)),a.Container=b,a.playContainer=b.querySelector("#JFAudioList"),b},d=function(b){var c;return b&&(b instanceof HTMLAudioElement||b instanceof Audio)?c=b:(c=g(b),a.playContainer.appendChild(c)),a.audioSource=c,a._playStatusHelper(c),a._safariHack(),c},e=function(a){var b=a["srcList"]||a["sourceList"]||[];f(b)},f=function(b){var e,g,i,j,h,k,l,m,n,o,c=!0;if("undefined"!=typeof a.input["autoplay"]&&0==a.input["autoplay"]&&(c=!1),0!=b.length){if(b[0]instanceof HTMLAudioElement||b[0]instanceof Audio)e=JFUtil.realArray(b),c?e[0].setAttribute("autoplay","autoplay"):e[0].removeAttribute("autoplay"),a.currentPlayList=e;else{for(g=document.querySelector("#JFAudioList"),h="",k=0,l=b.length;l>k;k++)i=b[k],j=0==k?c?'<audio preload="auto" src="'+i+'" data-src="'+i+'" autoplay></audio>':'<audio preload="auto" src="'+i+'" data-src="'+i+'"></audio>':'<audio preload="auto" src="'+i+'" data-src="'+i+'"></audio>',h+=j;g.innerHTML=h,m=g.getElementsByTagName("audio"),a.currentPlayList=JFUtil.realArray(m)}c&&(n=a.currentPlayList.shift(),n&&(o=d(n),JFUtil.addHandler(o,"ended",function(){f(a.currentPlayList)})))}},g=function(a){var e,b=!0,c=!1,d=!1;return"undefined"!=typeof a["autoplay"]&&0==a["autoplay"]&&(b=!1),"undefined"!=typeof a["loop"]&&1==a["loop"]&&(c=!0),"undefined"!=typeof a["muted"]&&1==a["muted"]&&(d=!0),e=document.createElement("audio"),a["source"]?(e=a["source"],e.setAttribute("preload","auto")):a["src"]?(e=document.createElement("audio"),e.setAttribute("preload","auto"),e.src=a["src"],e.type="audio/mpeg"):console.log("没有相应的资源，初始化失败"),b&&e.setAttribute("autoplay","autoplay"),c&&e.setAttribute("loop","loop"),d&&e.setAttribute("muted","muted"),e},JFAudioPlayer.prototype.stop=function(){a.audioStatus.playing&&(a.audioSource.currentTime=0,a.audioSource.pause())},JFAudioPlayer.prototype.pause=function(){a.audioStatus.playing&&a.audioSource.pause()},JFAudioPlayer.prototype.restart=function(){if(a.isRowPlay){var b=a.input["srcList"]||a.input["sourceList"]||[];a.input["autoplay"]=!0,f(b)}else a.audioSource.currentTime=0,a.audioSource.play()},JFAudioPlayer.prototype.start=function(){if(a.isRowPlay){var b=a.input["srcList"]||a.input["sourceList"]||[];a.input["autoplay"]=!0,f(b)}else(null===a.audioStatus.pause||a.audioStatus.pause)&&a.audioSource.play()},this._init()};
var JFAudioPlayer,jLog=function(a,b){var e,c=b||"tag：",d=document.querySelector("#debugArea");d||(d=document.createElement("div"),d.id="debugArea",_$("#resourceContainer").appendChild(d)),e="<section>"+c+"|time:"+(new Date).getTime()+"："+JSON.stringify(a)+"</section>",d.insertAdjacentHTML("beforeEnd",e)},_$=function(a){return document.querySelector(a)};window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,JFAudioPlayer=function(){"use strict";var b,c,d,a=function(a){var b=a||{};this.src=b.src,this.fatherContainer=b.fatherContainer,this.source=b.source,this.duration=0,this.config=b.config,this.initialed=!1,this.status={canplay:!1,ended:null,playing:!1,emptied:!1,pause:!0},this.init(b)};return a.prototype={start:function(){this.source.play()},pause:function(){this.source.pause()},stop:function(){this.source.pause(),this.source.currentTime=0},restart:function(){this.source.currentTime=0,this.source.play()},getCurrentTime:function(){return this.source.currentTime||0}},a.prototype.init=function(a){var b=function(a){var b=document.querySelector(a.fatherContainer);return b=b||document.querySelector("#JFAudioContainer"),b||(b=document.createElement("div"),b.id="JFAudioContainer",document.body.appendChild(b)),b},c=function(a){var b=a.config||{},c=document.createElement("audio"),d=!1;return"undefined"!=typeof b.loop&&b.loop===!0&&(d=!0),c.setAttribute("preload","auto"),c.src=a.src,c.type="audio/mpeg",d&&c.setAttribute("loop","loop"),c};if(!a)throw new Error("Please check your params");if(this.fatherContainer=b(a),!a.src)throw new Error("Lost the audio src");this.source=c(a)},b=function(a,b){var c,d,e,f,g;this.target=a,c=a,d=b,e=function(a){"function"==typeof a&&a()},f=function(){var b,a=c.config,e=function(a){a.target&&a.target.id&&"play_state"===a.target.id?(clearTimeout(b),document.removeEventListener("touchstart",e,!1)):(c.start(),d.$updateView(c),clearTimeout(b),document.removeEventListener("touchstart",e,!1))},f=function(){b=setTimeout(function(){c.status.playing||document.addEventListener("touchstart",e,!1)},500)};a.autoplay&&((client.browser.chrome>0||client.browser.firefox>0)&&"android"!==plat?c.start():"android_weixin"===uPlat?c.start():f())},g=function(a){var b=a.type,d=c.status,f=c.config;d[b]=!0,"ended"===b&&(d.pause=!0,d.playing=!1,e(f.ended)),"pause"===b&&(d.playing=!1),"playing"===b&&(d.pause=!1),"canplay"===b&&(c.duration=c.source.duration,e(f.canplay),c.initialed||(e(f.initialed),c.initialed=!0))},this.init=function(){var a=this.target.source;"undefined"!=typeof a&&(a.addEventListener("playing",g,!1),a.addEventListener("pause",g,!1),a.addEventListener("ended",g,!1),a.addEventListener("canplay",g,!1),a.addEventListener("emptied",g,!1)),f()},this.init()},c=function(a,b){var c=a||{},d=b||{},e=this,f=function(){var a=_$(".jfaudio-title"),b=_$("#audioPlayCover");a.innerHTML||(a.innerHTML=d.title),b.getAttribute("src")||b.setAttribute("src",d.img)},g=function(){var a="",b=null,d=function(){var e,f,g,h,a=c.duration,b=JFUtil.calAudioTime(a),d=c.getCurrentTime();_$(".end_time").innerHTML=b,e=JFUtil.calAudioTime(d),_$(".start_time").innerHTML=e,f=JFUtil.getRectBoxObj(_$(".progress_line")).width,g=Math.ceil(d)/Math.ceil(a)*f,h=_$(".progress_icon"),h.style.width=g+"px"},f=function(){_$("#resourceContainer")||document.body.insertAdjacentHTML("afterbegin",a),JFUtil.addHandler(_$("#resourceContainer"),"click",function(a){var b=a.target||a.srcElement,d=JFUtil.data(b,"action");"toggleAudioPlay"===d&&(c.status.playing?c.pause():c.start())},!1)};f(),b||(b=setInterval(function(){e.$updateView(c),d()},500))};f(),g()},c.prototype.$updateView=function(a){var b=a;if(b.status.playing)try{_$("#play_state").setAttribute("class","play2"),JFUtil.removeClass(_$("#audioPlayCover"),"toggleMusic")}catch(c){console.warn(c)}else try{_$("#play_state").setAttribute("class","pause2"),JFUtil.addClass(_$("#audioPlayCover"),"toggleMusic")}catch(c){console.warn(c)}},d=function(){this.audioList=[]},d.prototype={playToLast:function(){},playSingle:function(){},stopAll:function(){},next:function(){}},{initSingle:function(d){var e=new a(d),f=new c(e,d.info),g=new b(e,f);return{audio:e,listener:g,view:f}},initAudioList:function(){}}}();